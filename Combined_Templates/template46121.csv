1,"SELECT G.ra, G.dec, S.mjd, S.plate, S.fiberID, --- basic identifiers --- basic spectral data S.z, S.zErr, S.rChi2, S.velDisp, S.velDispErr, --- some useful imaging parameters G.extinction_r, G.petroMag_r, G.psfMag_r, G.psfMagErr_r, G.modelMag_u, modelMagErr_u, G.modelMag_g, modelMagErr_g, G.modelMag_r, modelMagErr_r, G.modelMag_i, modelMagErr_i, G.modelMag_z, modelMagErr_z, G.petroR5#_r, G.petroR9#_r, INTO mydb.SDSSspecgalsDR1# FROM SpecObj S CROSS APPLY dbo.fGetNearestObjEQ (S.ra, S.dec, #) N, Galaxy G, GalSpecInfo GSI, GalSpecLine GSL, GalSpecIndx GSX, GalSpecExtra GSE WHERE N.objID = G.objID AND GSI.specObjID = S.specObjID AND GSL.specObjID = S.specObjID AND GSX.specObjID = S.specObjID AND GSE.specObjID = S.specObjID --- add some quality cuts to get rid of obviously bad measurements AND (G.petroMag_r > # AND G.petroMag_r < #) AND (G.modelMag_u-G.modelMag_r) > # AND (G.modelMag_u-G.modelMag_r) < # AND (modelMag_u > # AND modelMag_u < #) AND (modelMag_g > # AND modelMag_g < #) AND (modelMag_r > # AND modelMag_r < #) AND (modelMag_i > # AND modelMag_i < #) AND (modelMag_z > # AND modelMag_z < #) AND S.rChi2 < # AND (S.zErr > # AND S.zErr < #) AND S.z > # --- end of query ---"
2019-06-17 17:53:00,1
