1,"select objects from both where the objIDs -- are the same. The output of the function is a table with the Galaxy Object -- ID and distance in arcmin from the input. This query introduces the use of -- a JOIN to combine table contents. Also, we use the # syntax, -- which will sort the output. DECLARE @ra_# bigint set @ra_# = MYDB.CIRs (#) DECLARE @dec_# bigint set @dec_# = MYDB.CIRs (#) --DECLARE @rad bigint set @rad = MYDB.CIRs (#) SELECT G.ra, G.dec, G.type, G.CmodelMag_g, G.CmodelMag_r into mydb.CIRs FROM Galaxy AS G CROSS APPLY dbo.fGetNearbyObjEq (@ra_#, @dec_#, #) AS GN -- this function outputs a table, so we have to do a join WHERE (G.flags & dbo.fPhotoFlags (#) ) = # -- and the object is not saturated. f.PhotoFlags is a function that interprets the flag bits. ORDER BY distance -- sort these by distance"
2019-12-03 03:27:00,1
