1,"SELECT search_id AS up_id, ra AS up_ra, dec AS up_dec FROM MyDB.HSPSC_#_pos CREATE TABLE #tmp (up_id int, objid bigint) INSERT INTO #tmp EXEC spGetNeighbors # -- # -- default. min = # INSERT INTO MyDB.SDSSphotDR1#_noWISE SELECT DISTINCT -- TOP # tmp.up_id AS search_id, po.objid AS phot_id, po.ra AS phot_ra, po.dec AS phot_dec, IS# (pz.z, #) AS phot_z, IS# (pz.zerr, #) AS phot_zerr, po.type AS phot_type, po.ndetect AS phot_ndet, po.clean AS phot_clean, IS# (sp.specobjid, #) AS spec_id, IS# (sp.ra, #) AS spec_ra, IS# (sp.dec, #) AS spec_dec, IS# (sp.z, #) AS spec_z, IS# (sp.zerr, #) AS spec_zerr, IS# (sp.class, #) AS spec_class, IS# (sp.instrument, #) AS spec_inst, po.cmodelmag_u AS cmodmag_u, po.cmodelmagerr_u AS cmoderr_u, po.fibermag_u AS fib3mag_u, po.fiber2mag_u AS fib2mag_u, po.extinction_u AS extinct_u, po.cmodelmag_g AS cmodmag_g, po.cmodelmagerr_g AS cmoderr_g, po.fibermag_g AS fib3mag_g, po.fiber2mag_g AS fib2mag_g, po.extinction_g AS extinct_g, po.cmodelmag_r AS cmodmag_r, po.cmodelmagerr_r AS cmoderr_r, po.fibermag_r AS fib3mag_r, po.fiber2mag_r AS fib2mag_r, po.extinction_r AS extinct_r, po.cmodelmag_i AS cmodmag_i, po.cmodelmagerr_i AS cmoderr_i, po.fibermag_i AS fib3mag_i, po.fiber2mag_i AS fib2mag_i, po.extinction_i AS extinct_i, po.cmodelmag_z AS cmodmag_z, po.cmodelmagerr_z AS cmoderr_z, po.fibermag_z AS fib3mag_z, po.fiber2mag_z AS fib2mag_z, po.extinction_z AS extinct_z, wx.wise_cntr AS wise_id, -- wa.ra AS wise_ra, wa.dec AS wise_dec, wx.match_dist AS wise_dist, wa.blend_ext_flags AS wise_flag, -- wa.w1mpro AS wise_promag_w1, wa.w1sigmpro AS wise_prosig_w1, wa.w1snr AS wise_prosnr_w1, wa.w1m AS wise_pronum_w1, wa.w1mag_# AS wise_apemag_w1, wa.w1sigmag_# AS wise_apesig_w1, -- wa.w2mpro AS wise_promag_w2, wa.w2sigmpro AS wise_prosig_w2, wa.w2snr AS wise_prosnr_w2, wa.w2m AS wise_pronum_w2, wa.w2mag_# AS wise_apemag_w2, wa.w2sigmag_# AS wise_apesig_w2, -- wa.w3mpro AS wise_promag_w3, wa.w3sigmpro AS wise_prosig_w3, wa.w3snr AS wise_prosnr_w3, wa.w3m AS wise_pronum_w3, wa.w3mag_# AS wise_apemag_w3, wa.w3sigmag_# AS wise_apesig_w3, -- wa.w4mpro AS wise_promag_w4, wa.w4sigmpro AS wise_prosig_w4, wa.w4snr AS wise_prosnr_w4, wa.w4m AS wise_pronum_w4, wa.w4mag_# AS wise_apemag_w4, wa.w4sigmag_# AS wise_apesig_w4, IS# (tm.j_m_k2#fe, #) AS tmass_mag_j, IS# (tm.j_msig_k2#fe, #) AS tmass_sig_j, IS# (tm.h_m_k2#fe, #) AS tmass_mag_h, IS# (tm.h_msig_k2#fe, #) AS tmass_sig_h, IS# (tm.k_m_k2#fe, #) AS tmass_mag_k, IS# (tm.k_msig_k2#fe, #) AS tmass_sig_k, IS# (ft.peak, #) AS first_peak, IS# (ft.rms, #) AS first_rms -- INTO MyDB.SDSSphotDR1#_noWISE -- SELECT COUNT (*) INTO tmp5 -- SELECT DISTINCT po.objid AS phot_id INTO tmp5 FROM #tmp tmp INNER JOIN PhotoPrimary po ON po.objid = tmp.objid LEFT OUTER JOIN Photoz pz ON pz.objid = po.objid LEFT OUTER JOIN SpecObj sp ON sp.bestobjid = po.objid LEFT OUTER JOIN WISE_xmatch wx ON wx.sdss_objid = po.objid LEFT OUTER JOIN WISE_allsky wa ON wa.cntr = wx.wise_cntr LEFT OUTER JOIN TwoMassXSC tm ON tm.objid = po.objid LEFT OUTER JOIN FIRST ft ON ft.objid = po.objid WHERE -- do not only use po.clean = # since sometimes it contains unknown check. (po.clean = # OR ( ((po.flags & #) ! = #) -- detected in BINNED1 AND ( (po.flags & #) = #) -- not NOPROFILE, PEAKCENTER, -- NOTCHECKED, PSF_FLUX_INTERP, -- SATURATED, or BAD_COUNTS_ERROR -- if you want to accept objects with -- interpolation problems for PSF mags, -- change this to:"
2019-02-24 00:21:00,1
