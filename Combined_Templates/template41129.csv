1,"SELECT t.idx_num, t.ra AS ra_t, t.dec AS dec_t, n.distance, p.ra AS ra_surr, p.dec AS dec_surr, z.z AS z_surr, z.zErr AS zErr_surr, p.petroMag_r AS petroMag_r_surr FROM MyDB.sample_t AS t CROSS APPLY dbo.fGetNearbyObjEq (t.ra, t.dec, t.theta) AS n JOIN PhotoObj AS p ON n.objid = p.objid JOIN Photoz AS z ON z.objid = n.objid WHERE (p.type = #) AND (z.z BETWEEN t.z - #*z.zErr and t.z + #*z.zErr) AND z.zErr < # /* DECLARE @cnt INT = #; WHILE @cnt < = # BEGIN DECLARE @ra1 FLOAT = (SELECT ra FROM mydb.target_galaxies WHERE idx_num = @cnt) DECLARE @dec1 FLOAT = (SELECT dec FROM mydb.target_galaxies WHERE idx_num = @cnt) DECLARE @theta1 FLOAT = (SELECT theta FROM mydb.target_galaxies WHERE idx_num = @cnt) DECLARE @z1 FLOAT = (SELECT z FROM mydb.target_galaxies WHERE idx_num = @cnt) -- DECLARE @name NVARCHAR (#) ; -- SET @name = # + @cnt SELECT p.ra, p.dec, z.z, z.zErr, p.petroMag_r -- INTO mydb. FROM PhotoObj p JOIN dbo.fGetNearbyObjEq (@ra1, @dec1, @theta1) n ON n.objID = p.objID JOIN Photoz z ON z.objID = n.objID WHERE p.type = # AND z.z < @z1 + #*z.zErr AND z.z > @z1 - #*z.zErr AND z.zErr < # SET @cnt = @cnt + #; END; */"
2019-05-22 11:23:00,1
