1,"SELECT p.objID, s.ra, s.dec, s.z as redshift, p.u, p.g, p.r, p.i, p.z, (p.u-p.r) as u_r, l.ew as d4#, s.eClass, p.lnlDev_r, p.lnlExp_r INTO lrgs FROM SpecObj as s, Galaxy as p, SpecLineIndex as l WHERE s.bestObjID = p.objID AND s.specClass = # AND s.zStatus > # AND (s.primTarget & # > #) AND s.z > # AND p.r < # AND l.specobjid = s.specobjid AND l.name = # ORDER BY p.objID CREATE TABLE #UPLOAD (up_ra FLOAT, up_dec FLOAT, up_rad FLOAT, up_id int) INSERT INTO #UPLOAD SELECT ra AS UP_RA, dec AS UP_DEC, rad as UP_RAD, id AS UP_ID SELECT n.id, n.objid, p.z, p.zErr, p.quality, n.r INTO redshifts FROM neighbors as n, dr5.photoz as p WHERE n.objid = p.objid ORDER BY n.id, n.objid UPDATE redshifts SET z = (SELECT TOP # d.z FROM dr5.specObj as d WHERE d.bestObjID = redshifts.objID AND d.zStatus > # AND d.z > #) WHERE EXISTS (SELECT TOP # d.z FROM dr5.specObj as d WHERE d.bestObjID = redshifts.objID AND d.zStatus > # AND d.z > #) UPDATE redshifts SET zErr = # WHERE EXISTS (SELECT top # d.zErr FROM dr5.specObj as d WHERE d.bestObjID = redshifts.objID AND d.zStatus > # AND d.z > #) DELETE FROM redshifts WHERE zErr > # SELECT s.* INTO groups FROM redshifts as s, lrgs as t WHERE s.id = t.id AND (s.z BETWEEN (t.redshift-s.zErr) AND (t.redshift + s.zErr) ) ORDER BY s.id, s.objid SELECT s.* INTO nofossils FROM lrgs as l, groups as s WHERE s.id = l.id AND (s.r < = (l.r + #) ) ORDER BY s.id, s.objid DELETE FROM fossils WHERE EXISTS (SELECT * FROM nofossils as g WHERE g.id = fossils.id)"
2019-02-18 16:36:00,1
