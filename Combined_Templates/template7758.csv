4,"select NASLOVI.NASLOV from BIBLIOTECKA_GRADJA bib, NASLOVI where bib.TIP_BIBLIOTECKE_GRADJE = # and bib.ID_NASLOVA = NASLOVI.ID_NASLOVA fetch next from master_curs into @ID_BIBLIOTECKE_GRADJE end close master_curs deallocate master_curs open master_curs fetch next from master_curs into @ID_BIBLIOTECKE_GRADJE while (@@FETCH_STATUS = #) begin Insert into @TableVar (NASLOV_PERIODIKA) select NASLOVI_SERIJSKE.KLJUCNI_NASLOV from BIBLIOTECKA_GRADJA as bib, NASLOVI_SERIJSKE where bib.TIP_BIBLIOTECKE_GRADJE = # and bib.ID_NASLOVA = NASLOVI_SERIJSKE.ID_NASLOVA_SERIJSKE fetch next from master_curs into @ID_BIBLIOTECKE_GRADJE end close master_curs deallocate master_curs declare master_curs_# cursor for Select ID_NASLOVA From @TableVar open master_curs_# fetch next from master_curs_# into @ID_NASLOVA while (@@FETCH_STATUS = #) begin Update @TableVar Set PISAC = (Select top # PREZIME + # + IME From AUTORI Join NASLOVI_AUTORI on AUTORI.ID_AUTORA = NASLOVI_AUTORI.ID_AUTORA and NASLOVI_AUTORI.ID_NASLOVA = @ID_NASLOVA) Where ID_NASLOVA = @ID_NASLOVA and NAZIV_DJELA is not # fetch next from master_curs_# into @ID_NASLOVA end close master_curs_# deallocate master_curs_# Update @TableVar Set OTPISANO = # Where ID_BIBLIOTECKE_GRADJE IN () Update @TableVar Set NAPOMENA = NAPOMENA + # + NAZIV_RAZLOGA_RASHODOVANJA + # + Cast (DATUM_OTPISA as nvarchar (#) ) Where ID_BIBLIOTECKE_GRADJE IN () and OTPISANO = # Update @TableVar Set TIP_NABAVE = # Where TIP_NABAVE = # Update @TableVar Set TIP_NABAVE = # Where TIP_NABAVE = # Update @TableVar Set TIP_NABAVE = # Where TIP_NABAVE = # Update @TableVar Set TIP_NABAVE = # + BROJ_RACUNA Where TIP_NABAVE = # Select TOP (#) ID_BIBLIOTECKE_GRADJE, ID_NASLOVA, INVENTARSKI_BROJ as REDNI_BROJ, SIGNATURA, DATUM_ZAVODJENJA, PISAC, NAZIV_DJELA + # + BROJ_IZDANJA + # + NAZIV_TIPA_IZDANJA + # + case When is# (BROJ_UNUTAR_NAKLADNICKE_CJELINE, #) > # then (NAZIV_NAKLADNICKE_CJELINE + #) else NAZIV_NAKLADNICKE_CJELINE end + BROJ_UNUTAR_NAKLADNICKE_CJELINE AS NAZIV_DJELA, NAZIV_IZDAVACA + # + NAZIV_MJESTA_IZDAVANJA + # + GODINA_IZDAVANJA as IZDAVAC, is# (POVEZANO, CAST (# as bit) ) as POVEZANO, is# (UNIKAT, CAST (# as bit) ) as UNIKAT, NASLOV_PERIODIKA, GODISTE_PERIODIKA, NASLOV_UNIKAT_PERIODIKA, GODISTE_UNIKAT_PERIODIKA, TIP_NABAVE, BROJ_RACUNA, BROJ_STRANA, CIJENA, OTPISANO, DATUM_OTPISA, NAZIV_RAZLOGA_RASHODOVANJA, NAPOMENA, STATUS_MEDIJA , PODACI_O_VLASNIKU_BAZE.KRACI_NAZIV_VLASNIKA AS NAZIV_VLASNIKA, PODACI_O_VLASNIKU_BAZE.ADRESA + # + is# (MJESTA_VLASNIK.NAZIV_MJESTA, #) AS ADRESA_VLASNIKA, PODACI_O_VLASNIKU_BAZE.TELEFON AS TELEFON_VLASNIKA, PODACI_O_VLASNIKU_BAZE.FAX AS FAX_VLASNIKA, PODACI_O_VLASNIKU_BAZE.E_MAIL AS EMAIL_VLASNIKA, PODACI_O_VLASNIKU_BAZE.WEB AS WEB_VLASNIKA from @TableVar LEFT JOIN PODACI_O_VLASNIKU_BAZE ON # = # left Join MJESTA as MJESTA_VLASNIK on PODACI_O_VLASNIKU_BAZE.ID_MJESTA = MJESTA_VLASNIK.ID_MJESTA where INVENTARSKI_BROJ = # or INVENTARSKI_BROJ = # ORDER BY CAST (dbo.CleanChars (INVENTARSKI_BROJ, #) AS float) , dbo.CleanNumbers (INVENTARSKI_BROJ) end"
2019-02-03 18:38:00,2
2019-02-03 18:40:00,2
