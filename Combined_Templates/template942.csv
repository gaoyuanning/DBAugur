7,"select snapnum , dbo.Shape::New (dbo.ConeSegment::New (#, #, #, #, #, #, @angle, dbo.math_max (@lo, lo) , dbo.math_min (@hi, hi) ).ToString () ) as shape from MyDB.MR_segments where lo < = @hi and hi > = @lo) , cover as (select snapnum, shape, c.* from lightcone cross apply dbo.fCover (#, @bits, @box, #, shape) c) select h.haloid, h.np, h.redshift, h.snapnum , h.x+sh.shiftx as x , h.y+sh.shifty as y , h.z+sh.shiftz as z into MyDB.lightcone1 from cover sh inner loop join MPAHalotrees.MR h on h.snapnum = sh.snapnum and h.phkey between sh.keymin and sh.keymax and sh.shape.ContainsPoint (h.x+sh.shiftx, h.y+sh.shifty, h.z+sh.shiftz) = #"
2019-01-04 10:39:00,2
2019-01-04 10:41:00,1
2019-01-04 10:42:00,1
2019-01-04 10:45:00,1
2019-01-04 10:51:00,1
2019-05-16 01:54:00,1
