1,"select school, floor(schoolyear/#) as fyear, avg(absent) as absent,avg(enrolled) as enrolled ,    avg(cast(absent as real))/avg(cast(enrolled as real)) as frAbsent  from schoolattendance group by school,floor(schoolyear/#) ) , r as ( select sl.location as location ,      a.*   from a    join schoollocation sl     on sl.fiscal_year=a.fyear     and sl.ATS_SYSTEM_CODE=a.school     and sl.LOCATION_CATEGORY_DESCRIPTION like &&& ), r2 as ( select mz._id, max(mz.the_geom.ToString()) as zLoc, count(*) as num ,      sum(cast(r.absent as real))/sum(r.enrolled) as fAbsent   from MSchoolZones mz     left outer join r on mz.the_geom.STContains(r.location)=#       and mz._year=r.fyear  group by mz._id  ) select *, case when num > # then fAbsent else # end as fAbsent   from r2"
2019-03-03 17:27:00,1
