1,"select #/# -- search radius, arcmin  declare @ra numeric       set @ra =  #	 -- a QSO declare @dec numeric      set @dec = #  declare @box numeric      set @box = # declare @ra1 numeric      set @ra1 = select @ra - @box/# declare @dec1 numeric     set @dec1 = select @dec - @box/# declare @ra2 numeric      set @ra2 = select @ra + @box/# declare @dec2 numeric     set @dec2 = select @dec + @box/#  declare @bad_flags bigint   set @bad_flags = (dbo.fPhotoFlags(&&&) |  		dbo.fPhotoFlags(&&&) | dbo.fPhotoFlags(&&&) |                  dbo.fPhotoFlags(&&&)) declare @star int	  set @star = dbo.fPhotoType(&&&) declare @galaxy int	  set @galaxy = dbo.fPhotoType(&&&)  declare @primaryMode int   set @primaryMode = dbo.fPhotoMode(&&&)  select     dbo.fSDSS(M.objId1) as UID,	     dbo.fSDSS(obj.objId) as ID,    ltrim(str(#*distance, #, #)) as distance,	     ltrim(str(mjd_r,#,#)) as MJD,    psfMag_r, psfMagErr_r,    dbo.fPhotoTypeN(type) as type from    (       select objId1, objId2, #/#. as distance FROM match       union all       select objId1, objId2, distance FROM match    ) as M    JOIN PhotoObj as Obj on (obj.objId = M.objId2)    join (select objId           from dbo.fGetObjFromRect(@ra1,@ra2,@dec1,@dec2)           where mode = @primaryMode) as N on (M.objId1 = N.objId1)    JOIN Field as F on (F.fieldId = obj.fieldId) where    # = (flags & @bad_flags) order by M.objId1"
2019-11-20 04:15:00,1
