2,"select snapnum       ,      dbo.Shape::New(dbo.ConeSegment::New(#,#,#,#,#,#, @angle, dbo.math_max(@lo, lo), dbo.math_min(@hi,hi)).ToString()) as shape        from MyDB.MR_segments         where lo <= @hi and hi >= @lo     ),     cover as (     select snapnum,shape,c.*     from lightcone cross apply dbo.fCover(&&&,@bits,@box,#,shape) c       )     select h.haloid,h.np,h.redshift, h.snapnum       ,    h.x+sh.shiftx as x       ,    h.y+sh.shifty as y       ,    h.z+sh.shiftz as z     from cover sh       inner loop join MPAHalotrees.MR h       on h.snapnum=sh.snapnum       and h.phkey between sh.keymin and sh.keymax       and sh.shape.ContainsPoint(h.x+sh.shiftx,h.y+sh.shifty,h.z+sh.shiftz)=#"
2019-01-04 10:32:00,1
2019-01-04 10:33:00,1
