3,"select v.*             from optw.tamass.VARIABLES v              where ID in (#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#)             ), -- needs query tracts as (     select TractID = ID, vintage, lon=centroid.Long, lat=centroid.Lat, wkt=geom.ToString()         , dist2geom = geom.STDistance(@center)         , dist2cent = centroid.STDistance(@center)         , m2 = geom.STArea()         , deg = geom.EnvelopeAngle()     from optw.tamass.TRACTS      where centroid.STDistance(@center) < # / # * # -- meters --         and geom.STArea() < #e9 -- m^#  ) select t.*, count_var = count(distinct c.VarID), total = sum(c.val), density = sum(c.val) / m2 * # from vars v join optw.tamass.VALS as c on c.VarID = v.ID          join tracts t on t.TractID = c.TractID and t.vintage = v.vintage where v.vintage = # -- need year       and c.VAL is not NULL group by t.TractID, t.vintage, lon, lat, wkt, dist2geom, dist2cent, m2, deg"
2019-12-01 12:38:00,1
2019-12-01 12:42:00,1
2019-12-01 12:47:00,1
