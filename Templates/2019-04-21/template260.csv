2,"SELECT  G.ra, G.dec, S.mjd, S.plate, S.fiberID, --- basic identifiers  --- basic spectral data  S.z, S.zErr, S.rChi2, S.velDisp, S.velDispErr,  --- some useful imaging parameters  G.extinction_r, G.petroMag_r, G.psfMag_r, G.psfMagErr_r,  G.modelMag_u, modelMagErr_u, G.modelMag_g, modelMagErr_g,  G.modelMag_r, modelMagErr_r, G.modelMag_i, modelMagErr_i,  G.modelMag_z, modelMagErr_z, G.petroR5#_r, G.petroR9#_r,  --- line fluxes for BPT diagram and other derived spec.parameters  GSL.nii_#_flux, GSL.nii_#_flux_err, GSL.h_alpha_flux,  GSL.h_alpha_flux_err, GSL.oiii_#_flux, GSL.oiii_#_flux_err,  GSL.h_beta_flux, GSL.h_beta_flux_err, GSL.h_delta_flux,  GSL.h_delta_flux_err, GSX.d4#, GSX.d4#_err, GSE.bptclass,  GSE.lgm_tot_p5#, GSE.sfr_tot_p5#, G.objID, GSI.specObjID INTO mydb.SDSSspecgalsDR8 FROM galSpec S CROSS APPLY   dbo.fGetNearestObjEQ(S.ra, S.dec, #) N, Galaxy G,  GalSpecInfo GSI, GalSpecLine GSL, GalSpecIndx GSX,   GalSpecExtra GSE WHERE N.objID = G.objID AND GSI.specObjID = S.specObjID AND GSL.specObjID = S.specObjID AND GSX.specObjID = S.specObjID AND GSE.specObjID = S.specObjID --- add some quality cuts to get rid of obviously bad measurements AND (G.petroMag_r > # AND G.petroMag_r < #) AND (G.modelMag_u-G.modelMag_r) > # AND (G.modelMag_u-G.modelMag_r) < # AND (modelMag_u > # AND modelMag_u < #) AND  (modelMag_g  >  #  AND  modelMag_g  <  #) AND  (modelMag_r  >  #  AND  modelMag_r  <  #) AND  (modelMag_i  >  #  AND  modelMag_i  <  #) AND  (modelMag_z  >  #  AND  modelMag_z  <  #) AND  S.rChi2 < # AND  (S.zErr > #  AND S.zErr < #) AND   S.z > #;"
2019-04-21 14:10:00,2
