1,"select hr.year, hr.numHr,p.nameFIrst, p.nameLast , hr.rank   from (     select year, playerId, numHr, rank() over (partition by year order by numHR desc) as rank       from (         select yearId as year, playerId, sum(hr) as numHR           from baseball.batting          group by yearId, playerId ) hrs      ) hr      join baseball.players p on p.playerid=hr.playerid   where hr.rank <=#   order by # desc,# desc"
2019-02-20 18:46:00,1
